---
작성일: "2023-08-10 23:05"
링크: https://www.aladin.co.kr/shop/wproduct.aspx?ItemId=276041776
---
#개발서적  #대규모시스템설계기초
## 연결문서
- [[index-1장 사용자 수에 따른 규모 확장성]]

## 정리
수직적 규모 확장은 소위 스케일 업(scale up)이라고 한다.  
스케일 업은 서버에 고사양 하드웨어(CPU, RAM ...)를 추가하여 앱의 처리 성능을 올리는 것을 말한다.  

수평적 규모 확장은 소위 스케일 아웃(scale out)이라고 한다.  
스케일 아웃은 더 많은 서버를 추가하여 즉, 분산 서버를 환경을 만들어 앱의 처리 성능을 올리는 것을 말한다.  

서버로 유입되는 트래픽이 적을 때는 스케일 업이 좋은 선택일 수 있지만 스케일 업에는 몇가지 단점이 존재한다.
1. 수직적 규모 확장에는 한계가 있다. 좋은 하드웨어를 무한대로 증설하는 것은 물리적으로 불가능하다.  
2. 수직적 규모 확장법은 장애에 대한 자동복구(failover) 방안이나 다중화(re-dundancy) 바안을 제시하지 않는다.  
3. 즉, 서버에 장애가 발생하면 앱은 완전히 중단된다.

### 웹 계층 스케일 아웃
웹 계층의 스케일 아웃의 경우 증설된 여러 서버를 하나의 로드밸런서로 연결하여 처리하는 것이 최선이다.
![2020230814153623.png|500x400](./images/Pasted%20image%2020230814153623.png)

로드밸런서 사용하면 가용성에서 이점을 누릴 수 있다.
1. 로드 밸런서는 공개 IP(Public IP)로 접속하게 하고, 스케일 아웃된 서버들은 사설 IP(Private IP)로 접속하게 한다.
2. 서버 1에서 장애가 발생하면 모든 트래픽은 다른 서버로 이동된다. 
3. 트래픽을 처리할 서버가 부족하면 바로 증설하여 처리가 가능하다.  
즉, 모든 서버에 장애가 발생하지 않는 이상 중단 없이 지속적인 서비스가 가능하다.
단점은 로드밸런서가 단일 장애지점이 될 수 있다.

### 데이터 계층 스케일 아웃 
주요 DBMS는 데이터베이스 다중화를 지원한다. 
데이터베이스 경우 주(master)-부(slave) 관계를 설정하고, 데이터의 원본은 주서버에 사본은 부서버에 저장하는 방식을 사용한다.

![2020230814153755.png|500x400](./images/Pasted%20image%2020230814153755.png)
이 경우 쓰기 연산은 master에서만 지원하고, slave의 경우 사본을 전달받아 읽기 연산만을 지원한다.
master 1개 slave 3개 이런식으로 구성해서 사용하는 경우가 많으며, 주로 쓰기 연산보다 읽기 연산이 많은 앱에서 사용한다.

위 같은 데이터베이스 다중화를 사용시 발생하는 이점은 크게 3가지가 있다.
1. 더 나은 성능 - 일반적인 앱의 경우 읽기 연산이 압도적으로 많은데 slave가 더 많기 때문에 성능상 이점을 가진다.
2. 안정성 - 원본이든 사본이든 모든 DB가 데이터를 가지고 있기 때문에 자연재해 등의 이유로 데이터가 파괴되어도 보존이 가능하다.
3. 가용성 - 마찬가지로 하나의 DB에 장애가 발생해도 다른 DB에 데이터가 있기 때문에 중단없이 서비스가 가능하다.
#### 데이터 베이스는 다중화 만하면 높은 가용성을 가질까?
slave 서버가 한 대 일 때, slave가 죽으면 master에서 일시적으로 읽기 쓰기 모든 작업을 수행하면 된다.  
master 서버가 한 대 일 때, 마찬가지로 master가 죽으면 slave 서버가 master의 역할 까지 받게 된다. 

여기서 복잡한 문제가 발생한다.
죽은 master의 최신 데이터가 slave에 아직 반영되지 못한 경우이며, 크게 3가지로 방안이 있다.
1. 복구 스크립트가 있다면 돌린다.
2. 다중 마스터(multi-masters) 방법 사용
3. 원형 다중화(circular replication) 방법 사용

### 웹 계층, 데이터 계층 다중화가 적용된 설계안
![2020230814154121.png|500](./images/Pasted%20image%2020230814154121.png)
